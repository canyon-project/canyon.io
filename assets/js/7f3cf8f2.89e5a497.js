"use strict";(self.webpackChunkcanyon_io=self.webpackChunkcanyon_io||[]).push([[944],{27:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>t,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>c,toc:()=>d});var i=s(4848),o=s(8453);const l={title:"\u5b89\u88c5 Canyon",sidebar_position:10},r=void 0,c={id:"getting-started/installing-canyon",title:"\u5b89\u88c5 Canyon",description:"\u5148\u51b3\u6761\u4ef6",source:"@site/docs/getting-started/installing-canyon.mdx",sourceDirName:"getting-started",slug:"/getting-started/installing-canyon",permalink:"/canyon.io/docs/getting-started/installing-canyon",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/getting-started/installing-canyon.mdx",tags:[],version:"current",sidebarPosition:10,frontMatter:{title:"\u5b89\u88c5 Canyon",sidebar_position:10},sidebar:"tutorialSidebar",previous:{title:"Key Differences",permalink:"/canyon.io/docs/overview/key-differences"},next:{title:"\u4e0a\u62a5\u7b2c\u4e00\u4e2a\u8986\u76d6\u7387\u6570\u636e",permalink:"/canyon.io/docs/getting-started/first-coverage"}},t={},d=[{value:"\u5148\u51b3\u6761\u4ef6",id:"\u5148\u51b3\u6761\u4ef6",level:2},{value:"\u7cfb\u7edf\u8981\u6c42",id:"\u7cfb\u7edf\u8981\u6c42",level:3},{value:"\u5b89\u88c5 Node.js\u3001npm\u3001pnpm",id:"\u5b89\u88c5-nodejsnpmpnpm",level:3},{value:"Node.js + npm",id:"nodejs--npm",level:4},{value:"pnpm",id:"pnpm",level:3},{value:"Docker",id:"docker",level:3},{value:"Postgres\u6570\u636e\u5e93",id:"postgres\u6570\u636e\u5e93",level:3},{value:"\u5b89\u88c5\u548c\u6784\u5efa",id:"\u5b89\u88c5\u548c\u6784\u5efa",level:2},{value:"\u914d\u7f6e\u73af\u5883",id:"\u914d\u7f6e\u73af\u5883",level:3},{value:"Node.js",id:"nodejs",level:3},{value:"Docker",id:"docker-1",level:3},{value:"\u542f\u52a8\u6210\u529f",id:"\u542f\u52a8\u6210\u529f",level:2}];function a(n){const e={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h2,{id:"\u5148\u51b3\u6761\u4ef6",children:"\u5148\u51b3\u6761\u4ef6"}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u60a8\u81ea\u5df1\u7684\u57fa\u7840\u8bbe\u65bd\u4e0a\u5b89\u88c5 Canyon \u7684\u5148\u51b3\u6761\u4ef6\u3002"}),"\n",(0,i.jsx)(e.p,{children:"Canyon \u662f\u4e00\u4e2aJavaScript\u4ee3\u7801\u8986\u76d6\u7387\u89e3\u51b3\u65b9\u6848\uff0c\u6253\u5305\u4e3a\u4e00\u7ec4 Docker \u5bb9\u5668\u3002\u60a8\u53ef\u4ee5\u5728\u4efb\u4f55\u53ef\u4ee5\u8fd0\u884cDocker Engine \u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u5b89\u88c5\u5e76\u8fd0\u884c Canyon \u3002\n\u60a8\u53ef\u4ee5\u5728\u672c\u5730\u8ba1\u7b97\u673a\u6216\u60a8\u9009\u62e9\u7684\u4e91\u63d0\u4f9b\u5546\u4e0a\u4f7f\u7528 Canyon\u3002"}),"\n",(0,i.jsx)(e.h3,{id:"\u7cfb\u7edf\u8981\u6c42",children:"\u7cfb\u7edf\u8981\u6c42"}),"\n",(0,i.jsx)(e.p,{children:"Canyon \u8bbe\u8ba1\u4e3a\u5728\u5c0f\u578b\u548c\u5927\u578b\u90e8\u7f72\u4e2d\u90fd\u80fd\u826f\u597d\u8fd0\u884c\u3002\u8fd0\u884c Canyon \u7684\u6700\u4f4e\u8981\u6c42\u662f\u64cd\u4f5c\u7cfb\u7edf\u652f\u6301 Docker \u548c 1 \u4e2a CPU \u6838\u5fc3 + 2GB RAM \u6765\u751f\u6210\u6784\u5efa\u6620\u50cf\u3002"}),"\n",(0,i.jsx)(e.h3,{id:"\u5b89\u88c5-nodejsnpmpnpm",children:"\u5b89\u88c5 Node.js\u3001npm\u3001pnpm"}),"\n",(0,i.jsx)(e.h4,{id:"nodejs--npm",children:"Node.js + npm"}),"\n",(0,i.jsxs)(e.p,{children:["\u5b89\u88c5 ",(0,i.jsx)(e.a,{href:"https://nodejs.org/en",children:(0,i.jsx)(e.code,{children:"Node.js"})})," (v18+) \u548c ",(0,i.jsx)(e.a,{href:"https://www.npmjs.com",children:(0,i.jsx)(e.code,{children:"npm"})})," (v9+)."]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://nodejs.org/en/download",children:"Node.js + npm \u5b89\u88c5\u624b\u518c"})}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"pnpm",children:"pnpm"}),"\n",(0,i.jsxs)(e.p,{children:["\u5b89\u88c5 ",(0,i.jsx)(e.a,{href:"https://pnpm.io",children:(0,i.jsx)(e.code,{children:"pnpm"})})," (v6+)."]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://pnpm.io/installation",children:"pnpm \u5b89\u88c5\u624b\u518c"})}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"docker",children:"Docker"}),"\n",(0,i.jsxs)(e.p,{children:["\u5b89\u88c5 ",(0,i.jsx)(e.a,{href:"https://www.docker.com",children:(0,i.jsx)(e.code,{children:"Docker"})})," (v20+)."]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://docs.docker.com/engine/install",children:"Docker \u5b89\u88c5\u624b\u518c"})}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"postgres\u6570\u636e\u5e93",children:"Postgres\u6570\u636e\u5e93"}),"\n",(0,i.jsx)(e.p,{children:"Canyon \u4f7f\u7528 Postgres \u6570\u636e\u5e93\u6765\u5b58\u50a8\u6240\u6709\u6570\u636e\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u60a8\u9009\u62e9\u7684\u4efb\u4f55 Postgres \u6570\u636e\u5e93\u63d0\u4f9b\u5546 - \u6258\u7ba1\u5728\u672c\u5730\u6216\u4e91\u63d0\u4f9b\u5546\u4e0a\u3002\u786e\u4fdd\u60a8\u62e5\u6709\u4ee5\u4e0b\u683c\u5f0f\u7684\u6709\u6548 Postgres \u6570\u636e\u5e93 URL\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"postgresql://username:password@url:5432/dbname\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u5b89\u88c5\u548c\u6784\u5efa",children:"\u5b89\u88c5\u548c\u6784\u5efa"}),"\n",(0,i.jsx)(e.p,{children:"\u4e86\u89e3\u5982\u4f55\u5b89\u88c5\u548c\u6784\u5efa Canyon \u793e\u533a\u7248\u3002"}),"\n",(0,i.jsx)(e.h3,{id:"\u914d\u7f6e\u73af\u5883",children:"\u914d\u7f6e\u73af\u5883"}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u5f00\u59cb\u5b89\u88c5\u4e4b\u524d\uff0c\u60a8\u9700\u8981\u914d\u7f6e\u73af\u5883\u53d8\u91cf\u3002"}),"\n",(0,i.jsx)(e.p,{children:".env.example\u5c06\u514b\u9686\u5b58\u50a8\u5e93\u6839\u76ee\u5f55\u4e2d\u627e\u5230\u7684\u6587\u4ef6\u5185\u5bb9\u590d\u5236\u5230.env\u73af\u5883\u53d8\u91cf\u5e76\u6dfb\u52a0\u60a8\u7684\u503c\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u786e\u4fdd\u73af\u5883\u503c\u4e0d\u5305\u542b\u5728\u5f15\u53f7\u5185\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"#-----------------------Backend Config------------------------------#\n# Prisma Config\nDATABASE_URL=postgresql://username:password@url:5432/dbname # or replace with your database URL\n\n# Auth Tokens Config\nJWT_SECRET=secretcode123\nTOKEN_SALT_COMPLEXITY=10\nMAGIC_LINK_TOKEN_VALIDITY=3\nREFRESH_TOKEN_VALIDITY=604800000\nACCESS_TOKEN_VALIDITY=86400000\nSESSION_SECRET=anothersecretcode123\n\n# Canyon App Domain Config\nREDIRECT_URL=http://localhost:3000\nWHITELISTED_ORIGINS=http://localhost:3170,http://localhost:3000,http://localhost:3100\nVITE_ALLOWED_AUTH_PROVIDERS=GOOGLE,GITHUB,MICROSOFT,EMAIL\n\n# Google Auth Config\nGOOGLE_CLIENT_ID=*****\nGOOGLE_CLIENT_SECRET=*****\nGOOGLE_CALLBACK_URL=http://localhost:3170/v1/auth/google/callback\nGOOGLE_SCOPE=email,profile\n\n# Github Auth Config\nGITHUB_CLIENT_ID=*****\nGITHUB_CLIENT_SECRET=****\nGITHUB_CALLBACK_URL=http://localhost:3170/v1/auth/github/callback\nGITHUB_SCOPE=user:email\n\n# Microsoft Auth Config\nMICROSOFT_CLIENT_ID=*****\nMICROSOFT_CLIENT_SECRET=*****\nMICROSOFT_CALLBACK_URL=http://localhost:3170/v1/auth/microsoft/callback\nMICROSOFT_SCOPE=user.read\nMICROSOFT_TENANT=common\n\n# Mailer config\nMAILER_SMTP_URL=smtps://user@domain.com:pass@smtp.domain.com\nMAILER_ADDRESS_FROM=from@example.com\n\n# Rate Limit Config\nRATE_LIMIT_TTL=60\nRATE_LIMIT_MAX=100\n\n#-----------------------Frontend Config------------------------------#\n\n# Base URLs\nVITE_BASE_URL=http://localhost:3000\nVITE_SHORTCODE_BASE_URL=http://localhost:3000\nVITE_ADMIN_URL=http://localhost:3100\n\n# Backend URLs\nVITE_BACKEND_GQL_URL=http://localhost:3170/graphql\nVITE_BACKEND_WS_URL=wss://localhost:3170/graphql\nVITE_BACKEND_API_URL=http://localhost:3170/v1\n\n# Terms Of Service And Privacy Policy Links (Optional)\nVITE_APP_TOS_LINK=https://docs.Canyon.io/support/terms\nVITE_APP_PRIVACY_POLICY_LINK=https://docs.Canyon.io/support/privacy\n\nENABLE_SUBPATH_BASED_ACCESS=false\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8ba9\u6211\u4eec\u6765\u4e86\u89e3\u4e00\u4e0b\u4e3b\u8981\u7684\u73af\u5883\u53d8\u91cf\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"DATABASE_URL"}),": This is where you add your Postgres database URL."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"TOKEN_SALT_COMPLEXITY"}),": Defines the complexity of the SALT that is used for hashing - a higher number implies a more complex salt."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"MAGIC_LINK_TOKEN_VALIDITY"}),":Duration"," of the validity of the magic link being sent to sign in to Canyon (in days)."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"REFRESH_TOKEN_VALIDITY"}),": Validity of the refresh token for auth (in ms)."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"ACCESS_TOKEN_VALIDITY"}),": Validity of the access token for auth (in ms)."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"JWT_SECRET"}),", ",(0,i.jsx)(e.code,{children:"SESSION_SECRET"}),": Secret Keys for security purposes."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"REDIRECT_URL"}),": This is a fallback URL to debug when the actual redirects fail."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"WHITELISTED_ORIGINS"}),": URLs of Canyon backend, admin dashboard, and the frontend app."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"VITE_ALLOWED_AUTH_PROVIDERS"}),": Allows you to specify which auth providers you want to enable."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"MAILER_SMTP_URL"}),": The SMTP URL for email delivery."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"MAILER_ADDRESS_FROM"}),": The email address that you would be using."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"RATE_LIMIT_TTL"}),": The time it takes to refresh the maximum number of requests being received."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"RATE_LIMIT_MAX"}),": The maximum number of requests that Canyon can handle under ",(0,i.jsx)(e.code,{children:"RATE_LIMIT_TTL"}),"."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"VITE_BASE_URL"}),": This is the URL where your deployment will be accessible from."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"VITE_SHORTCODE_BASE_URL"}),": A URL to generate shortcodes for sharing, can be the same as ",(0,i.jsx)(e.code,{children:"VITE_BASE_URL"}),"."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"VITE_BACKEND_GQL_URL"}),": The URL for GraphQL within the instance."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"VITE_BACKEND_WS_URL"}),": The URL for WebSockets within the instance."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"VITE_BACKEND_API_URL"}),": The URL for REST APIs within the instance."]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"VITE_APP_TOS_LINK"})," and ",(0,i.jsx)(e.code,{children:"VITE_APP_PRIVACY_POLICY_LINK"})," are optional and are used to configure the links to the Terms & Conditions and Privacy Policy."]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["Third-party auth configs have to be obtained from the respective providers. You can choose and configure the auth providers by following the ",(0,i.jsx)(e.a,{href:"/documentation/self-host/community-edition/prerequisites#oauth",children:"configuring OAuth guide"}),"."]}),"\n",(0,i.jsx)(e.h3,{id:"nodejs",children:"Node.js"}),"\n",(0,i.jsx)(e.p,{children:"\u514b\u9686\u9879\u76ee"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"git clone https://github.com/canyon-project/canyon\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5b89\u88c5\u4f9d\u8d56\u9879"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"pnpm install\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u4fee\u6539.env\u6587\u4ef6\uff0c\u4f7f\u7528nodejs\u8fd0\u884c\u9879\u76ee"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"node packages/canyon-backend/dist/main.js\n"})}),"\n",(0,i.jsx)(e.h3,{id:"docker-1",children:"Docker"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"docker run canyon\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u542f\u52a8\u6210\u529f",children:"\u542f\u52a8\u6210\u529f"}),"\n",(0,i.jsx)(e.p,{children:"\u542f\u52a8\u6210\u529f\u540e\u4f1a\u6709\u4e09\u4e2a\u4e3b\u8981\u7684\u670d\u52a1\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Canyon frontend"}),"\n",(0,i.jsx)(e.li,{children:"Canyon backend"}),"\n",(0,i.jsx)(e.li,{children:"Canyon task"}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(a,{...n})}):a(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>r,x:()=>c});var i=s(6540);const o={},l=i.createContext(o);function r(n){const e=i.useContext(l);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:r(n.components),i.createElement(l.Provider,{value:e},n.children)}}}]);